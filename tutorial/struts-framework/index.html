<!doctype html><html lang="cs"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,maximum-scale=2.2,minimum-scale=1"><link rel="icon" type="image/svg+xml" href="../../static/img/favicon.svg"><meta name="author" content="Jiří Satora"><meta name="description" content="V této části si představíme framework jménem Struts (přesněji Struts 2)."><title>Struts framework | Servlety a JSP - Návod</title><script src="../../static/js/highlight.min.js"></script><script>hljs.highlightAll()</script><script defer="defer" src="../../common.094d85ce485e92e2c2cb.js"></script><script defer="defer" src="../../618.274f04aa314232891610.js"></script><script defer="defer" src="../../tutorial.eb9162178c9dddad389b.js"></script><link href="../../css/style.9befb716022502a8a300.css" rel="stylesheet"></head><body><input type="hidden" id="PATH_TO_ROOT" value="../../"><header id="HeaderContainer" class="header"><div id="Header" class="header__container"><div class="header__content"><a href="../../" class="header__home-link">Servlety a JSP<span class="header__home-link-unimportant-part"> - Návod</span></a> <button id="NavigationToggleButton" class="menu-toggle-button">Otevřít/Zavřít menu<span class="menu-toggle-button__icon"></span></button><nav id="HeaderNavigation" class="header__navigation"><ul><li><a href="../../tutorial/priprava-pro-vyvoj/" class="header__navigation-link header__navigation-link--active">Tutoriál</a></li><li><a href="../../obsah/" class="header__navigation-link">Obsah</a></li><li><a href="../../dalsi-tutorialy/k-cemu-tato-sekce-slouzi/" class="header__navigation-link">Další tutoriály</a></li><li><a href="https://github.com/Jirkasa/servlety-a-jsp-navod" target="_blank" class="header__navigation-link">GitHub</a></li></ul></nav></div></div></header><div class="tutorial-page-layout"><div class="tutorial-page-layout__container"><nav id="TutorialNavigation" class="tutorial-page-layout__navigation-side"><ul class="navigation"><li><a href="../priprava-pro-vyvoj/" class="navigation__link">Příprava pro vývoj</a></li><li><a href="../uvod-do-servletu/" class="navigation__link">Úvod do Servletů</a></li><li><a href="../http-servlet/" class="navigation__link">HTTP Servlet</a></li><li><a href="../sledovani-relace/" class="navigation__link">Sledování relace</a></li><li><a href="../komunikace-mezi-servlety/" class="navigation__link">Komunikace mezi Servlety</a></li><li><a href="../filtry/" class="navigation__link">Filtry</a></li><li><a href="../uvod-do-jsp/" class="navigation__link">Úvod do JSP</a></li><li><a href="../jsp-tagy-a-implicitni-objekty/" class="navigation__link">JSP tagy a implicitní objekty</a></li><li><a href="../jsp-direktivy/" class="navigation__link">JSP direktivy</a></li><li><a href="../jsp-action-tagy/" class="navigation__link">JSP action tagy</a></li><li><a href="../jsp-custom-tagy/" class="navigation__link">JSP custom tagy</a></li><li><a href="../jsp-expression-language/" class="navigation__link">JSP expression language</a></li><li><a href="../jstl/" class="navigation__link">JSTL</a></li><li><a href="../mvc-vzor/" class="navigation__link">MVC vzor</a></li><li><a href="../struts-framework/" class="navigation__link navigation__link--active">Struts framework</a></li><li><a href="../prace-s-databazi/" class="navigation__link">Práce s databází</a></li></ul></nav><main class="tutorial-page-layout__content"><h1 class="heading-primary u-mb-4">Struts framework</h1><p class="paragraph u-mb-4">V této části si představíme framework jménem <a href="https://struts.apache.org/index.html" target="_blank" class="link">Struts</a> (přesněji Struts 2). Jedná se o framework, který je postavený na MVC vzoru a vývoj webových aplikací je pro nás díky němu jednodušší. Nebudeme jej rozebírat příliš do hloubky. Akorát si ukážeme, jakým způsobem se s ním pracuje. Pokud by vás zaujal a rozhodli se o něm dozvědět více, tak můžete navštívít třeba <a href="https://struts.apache.org/getting-started/" target="_blank" class="link">dokumentaci</a>.</p><h2 id="komponenty-struts-2-frameworku" class="heading-secondary u-mb-2">Komponenty Struts 2 frameworku</h2><p class="paragraph u-mb-2">Struts 2 se trochu liší od tradičního MVC frameworku. Controller v tomto případě mapuje příchozí requesty na action třídy. Představuje jej dispatcher, což je servlet filter, který je namapován na všechny URL. Action třídy jsou zodpovědné za zpracování requestů. Action třída ve Struts 2 představuje v podstatě model, ale kromě toho že zpracovává requesty a může pracovat s databází, tak je také zodpovědná za výběr JSP stránky (view) k vyrenderování. Kromě JSP stránek Struts podporuje také třeba šablonovací systémy jako je FreeMarker nebo Velocity. Navíc můžeme namísto stránky vytvářet i JSON nebo XML.</p><p class="paragraph u-mb-4">Struts 2 framework obsahuje ještě další komponenty, ale tím už se zabývat nebudeme. Jak jsem psal, Struts framework si tu jen představíme a vyzkoušíme použít.</p><h2 id="ukazka-tvorby-projektu" class="heading-secondary u-mb-2">Ukázka tvorby projektu</h2><p class="paragraph u-mb-2">Pro ukázku práce se Struts frameworkem si vytvoříme úplně jednoduchou aplikaci. Uživateli se zobrazí stránka s formulářem, na které zadá jméno a příjmení. Po odeslání tohoto formuláře se mu vrátí stránka, která jej pozdraví.</p><p class="paragraph u-mb-2">Založíme si nový Maven projekt, a začneme tím, že si do souboru pom.xml kromě závislosti pro servlety přidáme také <a href="https://mvnrepository.com/artifact/org.apache.struts/struts2-core" target="_blank" class="link">závislost pro Struts 2 framework</a>.</p><div data-project="1" data-project-name="struts-projekt" class="u-mb-2"><ul data-project-folders><li>src<ul><li>main<ul><li data-java-packages-folder>java</li><li>resources</li><li>webapp</li></ul></li><li>test<ul><li>java</li><li>resources</li></ul></li></ul></li><li>target</li></ul><pre data-code="pom.xml" data-active data-code-highlight="24-28"><code class="language-xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;io.github.jirkasa&lt;/groupId&gt;
    &lt;artifactId&gt;struts-projekt&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;name&gt;struts-projekt&lt;/name&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;17&lt;/java.version&gt;
        &lt;maven.compiler.source&gt;${java.version}&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;${java.version}&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;4.0.1&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;
            &lt;artifactId&gt;struts2-core&lt;/artifactId&gt;
            &lt;version&gt;6.3.0.2&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre></div><p class="paragraph u-mb-2">První věc, kterou uděláme, je vytvoření web.xml souboru a nastavení filtru StrutsPrepareAndExecuteFilter ze Struts knihovny pro všechny příchozí requesty. Tento filtr vlastně představuje controller, který podle URL volá odpovídající action třídy. Následující ukázka ukazuje, jak jej v souboru web.xml můžeme nastavit.</p><div data-project="2" data-project-extends="1" class="u-mb-2"><ul data-project-commands><li data-command-create-folder>src/main/webapp/WEB-INF</li><li data-command-open-folder-to-root>src/main/webapp/WEB-INF</li></ul><pre data-code="web.xml" data-folder="src/main/webapp/WEB-INF" data-active><code class="language-xml">&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://Java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" 
id="WebApp_ID" version="3.0"&gt;
    &lt;filter&gt;
        &lt;filter-name&gt;struts2&lt;/filter-name&gt;
        &lt;filter-class&gt;org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;
    &lt;/filter&gt;

    &lt;filter-mapping&gt;
        &lt;filter-name&gt;struts2&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;
&lt;/web-app&gt;</code></pre></div><p class="paragraph u-mb-2">Nyní se o mapování requestů bude starat Struts framework. Můžeme vytvořit action pro hlavní stránku, na které uživatel bude moci zadat své jméno a příjmení. Jelikož se jedná jen o vyrenderování stránky, tak ani nebudeme vytvářet žádnou action třídu, protože můžeme pro action (URL) nastavit přímo JSP stránku. JSP stránku vytvoříme ve složce WEB-INF/jsp, aby k ní uživatelé neměli přímý přístup a můžeme ji nazvat třeba jako "Home.jsp". Následující ukázka ukazuje její kód. Formulář směřuje na action vysledek, kterou později vytvoříme.</p><div data-project="3" data-project-extends="2" class="u-mb-2"><ul data-project-commands><li data-command-create-folder>src/main/webapp/WEB-INF/jsp</li><li data-command-open-folder-to-root>src/main/webapp/WEB-INF/jsp</li></ul><pre data-code="Home.jsp" data-folder="src/main/webapp/WEB-INF/jsp" data-active><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Struts Framework&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="./vysledek.action" method="POST"&gt;
        &lt;label for="jmeno"&gt;Jméno:&lt;/label&gt; &lt;input type="text" id="jmeno" name="jmeno" /&gt;
        &lt;br&gt;&lt;br&gt;
        &lt;label for="prijmeni"&gt;Příjmení:&lt;/label&gt; &lt;input type="text" id="prijmeni" name="prijmeni" /&gt;
        &lt;br&gt;&lt;br&gt;
        &lt;button&gt;Odeslat&lt;/button&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p class="paragraph u-mb-2">Struts se konfiguruje v souboru struts.xml, který se vytváří v src/main/resources složce. Tato složka slouží k ukládání věcí, které nejsou Java třídy. Následující ukázka ukazuje základní kód souboru. Kořenovým elementem je element struts.</p><div data-project="4" data-project-extends="3" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/resources</li></ul><pre data-code="struts.xml" data-folder="src/main/resources" data-active><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;
&lt;struts&gt;
&lt;/struts&gt;</code></pre></div><p class="paragraph u-mb-2">Pomocí elementu constant a nastavením jeho atributu name na "struts.devMode" můžeme atributem value nastavit, zda se má aplikace spustit v módu pro vývoj. To nyní chceme, takže nastavíme atribut value na hodnotu true.</p><div data-project="5" data-project-extends="4" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/resources</li></ul><pre data-code="struts.xml" data-folder="src/main/resources" data-active data-code-highlight="6"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;
&lt;struts&gt;
    &lt;constant name="struts.devMode" value="true" /&gt;
&lt;/struts&gt;</code></pre></div><p class="paragraph u-mb-2">Teď v souboru struts.xml nadefinujeme action pro naši vytvořenou JSP stránku. To se dělá uvnitř elementu package (nebudu zabýhat do detailů) elementem action, kde atributem name nastavíme název action a pomocí podelementu result JSP stránku, která se má použít. Následující ukázka ukazuje upravený soubor. Jako název action nastavujeme prázdný řetězec, aby se použila pro domovskou stránku. Nevím jestli je to úplně správné řešení, ale funguje to.</p><div data-project="6" data-project-extends="5" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/resources</li></ul><pre data-code="struts.xml" data-folder="src/main/resources" data-active data-code-highlight="8-12"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;
&lt;struts&gt;
    &lt;constant name="struts.devMode" value="true" /&gt;

    &lt;package name="default" extends="struts-default"&gt;
        &lt;action name=""&gt;
            &lt;result&gt;/WEB-INF/jsp/Home.jsp&lt;/result&gt;
        &lt;/action&gt;
    &lt;/package&gt;
&lt;/struts&gt;</code></pre></div><p class="paragraph u-mb-2">Po spuštění aplikace a navštívení <a href="http://localhost:8080/struts-projekt/" target="_blank" class="link">http://localhost:8080/struts-projekt/</a> by jste měli vidět stránku, kterou ukazuje následující obrázek.</p><img src="../../static/img/screenshots/StrutsFrameworkPrikladUvodniStranka.png" alt="vygenerovaná stránka" class="image image--full-width image--with-border u-mb-2"><p class="paragraph u-mb-2">Teď si založíme action pro zpracování formuláře a zobrazení stránky s pozdravem. Tentokrát již budeme potřebovat i action třídu, jelikož budeme zpracovávat formulář. Action třídy jsou ve Struts 2 jednoduše POJO (Plain Old Java Object), takže nemusí dědit od žádné třídy. Akorát mohou obsahovat execute metodu, která se volá pro zpracování requestu. Založíme si tedy třídu (v nějakém Java balíčku), kterou můžeme pojmenovat jako Vysledek. Jako vlastnosti jí nastavíme položky, které se posílají ve formuláři. Vytvoříme pro ně také gettery a settery a automaticky se jim z odeslaného formuláře nastaví hodnoty. Následující ukázka ukazuje kód třídy.</p><div data-project="7" data-project-extends="6" class="u-mb-2"><pre data-code="Vysledek.java" data-java-package="io.github.jirkasa" data-java-package-opened data-active><code class="language-java">package io.github.jirkasa;

public class Vysledek {
    private String jmeno;
    private String prijmeni;
    
    public String getJmeno() {
        return jmeno;
    }
    public void setJmeno(String jmeno) {
        this.jmeno = jmeno;
    }
    public String getPrijmeni() {
        return prijmeni;
    }
    public void setPrijmeni(String prijmeni) {
        this.prijmeni = prijmeni;
    }
}</code></pre></div><p class="paragraph u-mb-2">Pro action vytvoříme JSP stránku jménem "Vysledek.jsp", ve které hodnoty formuláře použijeme při tvorbě pozdravu. Ukazuje ji následující ukázka. Pro výpis hodnot se používá tag jménem property z knihovny tagů, které nám Struts framework poskytuje pod uri "/struts-tags".</p><div data-project="8" data-project-extends="7" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/webapp/WEB-INF/jsp</li></ul><pre data-code="Vysledek.jsp" data-folder="src/main/webapp/WEB-INF/jsp" data-active><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;%@ taglib uri="/struts-tags" prefix="s" %&gt;  

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Struts Framework&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;Ahoj &lt;s:property value="jmeno"/&gt; &lt;s:property value="prijmeni"/&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p class="paragraph u-mb-2">Teď si action nadefinujeme v souboru struts.xml, jak ukazuje následující ukázka. Jméno action jsme nastavili na "vysledek", jelikož na tuto action odkazuje formulář na úvodní stránce a atributem class jsme nastavili action třídu. Elementu result jsme také nastavili název pomocí atributu name. To bychom dělat nemuseli, ale chtěl bych vám u action třídy ukázat metodu execute.</p><div data-project="9" data-project-extends="8" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/resources</li></ul><pre data-code="struts.xml" data-folder="src/main/resources" data-active data-code-highlight="12-14"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd"&gt;
&lt;struts&gt;
    &lt;constant name="struts.devMode" value="true" /&gt;

    &lt;package name="default" extends="struts-default"&gt;
        &lt;action name=""&gt;
            &lt;result&gt;/WEB-INF/jsp/Home.jsp&lt;/result&gt;
        &lt;/action&gt;
        &lt;action name="vysledek"&gt;
            &lt;result name="stranka"&gt;/WEB-INF/jsp/Vysledek.jsp&lt;/result&gt;
        &lt;/action&gt;
    &lt;/package&gt;
&lt;/struts&gt;</code></pre></div><p class="paragraph u-mb-2">Metoda execute v action třídě určuje, jaká stránka se má vyrenderovat. Action totiž může mít nastavených více result elementů. V naší třídě tedy metodu execute implementujeme a vrátíme v ní název, který jsme nastavili result elementu.</p><div data-project="10" data-project-extends="9" class="u-mb-2"><pre data-code="Vysledek.java" data-java-package="io.github.jirkasa" data-java-package-opened data-active data-code-highlight="20-22"><code class="language-java">package io.github.jirkasa;

public class Vysledek {
    private String jmeno;
    private String prijmeni;
    
    public String getJmeno() {
        return jmeno;
    }
    public void setJmeno(String jmeno) {
        this.jmeno = jmeno;
    }
    public String getPrijmeni() {
        return prijmeni;
    }
    public void setPrijmeni(String prijmeni) {
        this.prijmeni = prijmeni;
    }

    public String execute() {
        return "stranka";
    }
}</code></pre></div><p class="paragraph u-mb-2">Naše aplikace je hotová. Pokud si na úvodní stránce zkusíte vyplnit jméno a příjmení, tak se vám zobrazí stránka s pozdravem.</p><img src="../../static/img/screenshots/StrutsFrameworkPrikladStrankaSPozdravem.png" alt="stránka s pozdravem" class="image image--full-width image--with-border u-mb-6"><p class="paragraph u-mb-4">Více se Struts frameworkem zabývat nebudeme. Tato část měla za cíl vám ho jen představit. Pokud se o něm chcete dozvědět více, tak si musíte najít jiný zdroj.</p><div class="u-text-center"><a href="../prace-s-databazi/" class="button-primary">Pokračovat na další část</a></div></main></div></div><footer class="footer"><div class="footer__content"><p class="footer__text">Tento web vytvořil <a href="https://jirkasa.github.io/" target="_blank" class="footer__link">Jiří Satora</a></p></div></footer></body></html>