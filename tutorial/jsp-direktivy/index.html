<!doctype html><html lang="cs"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,maximum-scale=2.2,minimum-scale=1"><link rel="icon" type="image/svg+xml" href="../../static/img/favicon.svg"><meta name="author" content="Jiří Satora"><meta name="description" content="V této části tutoriálu se podíváme na JSP direktivy."><title>JSP direktivy | Servlety a JSP - Návod</title><script src="../../static/js/highlight.min.js"></script><script>hljs.highlightAll()</script><script defer="defer" src="../../common.094d85ce485e92e2c2cb.js"></script><script defer="defer" src="../../618.274f04aa314232891610.js"></script><script defer="defer" src="../../tutorial.eb9162178c9dddad389b.js"></script><link href="../../css/style.dc6eaf064d238b949478.css" rel="stylesheet"></head><body><input type="hidden" id="PATH_TO_ROOT" value="../../"><header id="HeaderContainer" class="header"><div id="Header" class="header__container"><div class="header__content"><a href="../../" class="header__home-link">Servlety a JSP<span class="header__home-link-unimportant-part"> - Návod</span></a> <button id="NavigationToggleButton" class="menu-toggle-button">Otevřít/Zavřít menu<span class="menu-toggle-button__icon"></span></button><nav id="HeaderNavigation" class="header__navigation"><ul><li><a href="../../tutorial/priprava-pro-vyvoj/" class="header__navigation-link header__navigation-link--active">Tutoriál</a></li><li><a href="../../obsah/" class="header__navigation-link">Obsah</a></li><li><a href="../../dalsi-tutorialy/k-cemu-tato-sekce-slouzi/" class="header__navigation-link">Další tutoriály</a></li><li><a href="https://github.com/Jirkasa/servlety-a-jsp-navod" target="_blank" class="header__navigation-link">GitHub</a></li></ul></nav></div></div></header><div class="tutorial-page-layout"><div class="tutorial-page-layout__container"><nav id="TutorialNavigation" class="tutorial-page-layout__navigation-side"><ul class="navigation"><li><a href="../priprava-pro-vyvoj/" class="navigation__link">Příprava pro vývoj</a></li><li><a href="../uvod-do-servletu/" class="navigation__link">Úvod do Servletů</a></li><li><a href="../http-servlet/" class="navigation__link">HTTP Servlet</a></li><li><a href="../sledovani-relace/" class="navigation__link">Sledování relace</a></li><li><a href="../komunikace-mezi-servlety/" class="navigation__link">Komunikace mezi Servlety</a></li><li><a href="../filtry/" class="navigation__link">Filtry</a></li><li><a href="../uvod-do-jsp/" class="navigation__link">Úvod do JSP</a></li><li><a href="../jsp-tagy-a-implicitni-objekty/" class="navigation__link">JSP tagy a implicitní objekty</a></li><li><a href="../jsp-direktivy/" class="navigation__link navigation__link--active">JSP direktivy</a></li><li><a href="../jsp-action-tagy/" class="navigation__link">JSP action tagy</a></li><li><a href="../jsp-custom-tagy/" class="navigation__link">JSP custom tagy</a></li><li><a href="../jsp-expression-language/" class="navigation__link">JSP expression language</a></li><li><a href="../jstl/" class="navigation__link">JSTL</a></li><li><a href="../mvc-vzor/" class="navigation__link">MVC vzor</a></li><li><a href="../struts-framework/" class="navigation__link">Struts framework</a></li><li><a href="../prace-s-databazi/" class="navigation__link">Práce s databází</a></li></ul></nav><main class="tutorial-page-layout__content"><h1 class="heading-primary u-mb-4">JSP direktivy</h1><p class="paragraph u-mb-2">V této části se podíváme na direktivy. Jedná se o elementy, které web containeru (Tomcatu) říkají, jak má JSP stránku převést na servlet. Syntaxe pro direktivu je následující (pokud máme více atributů, tak je můžeme oddělit mezerou):</p><div data-code-box data-no-buttons class="u-mb-4"><pre data-code><code class="language-html">&lt;%@ direktiva atribut="hodnota" %&gt;</code></pre></div><h2 id="typy-direktiv" class="heading-secondary u-mb-2">Typy direktiv</h2><p class="paragraph u-mb-1">Existují tři typy direktiv poskytující různé atributy, které můžeme použít. Následující seznam je popisuje:</p><ul class="list u-mb-4"><li><b>page</b> - definuje atributy k obecnému nastavení JSP stránky</li><li><b>include</b> - používá se k vložení obsahu z jiného souboru do JSP stránky</li><li><b>taglib</b> - používá se k nadefinování knihovny tagů, abychom ji mohli použít</li></ul><h2 id="page-direktiva" class="heading-secondary u-mb-2">Page direktiva</h2><p class="paragraph u-mb-2">Page direktiva definuje atributy, které popisuje následující tabulka. Jedná se o atributy, které slouží k obecnému nastavení JSP stránky.</p><div class="table-wrapper u-mb-2"><table class="table"><thead><tr><th>Atribut</th><th>Hodnota</th><th>Popis</th></tr></thead><tbody><tr><td>import</td><td>třída | rozhraní | balíček</td><td>Importuje třídu, rozhraní, nebo celý balíček (podobné jako klíčové slovo import v Javě).</td></tr><tr><td>contentType</td><td>MIME type</td><td>Definuje jaký obsah se vrací v HTTP response (defaultně je to HTML stránka - text/html)</td></tr><tr><td>extends</td><td>třída</td><td>Definuje nadtřídu vygenerovaného servletu (používá se velmi zřídka).</td></tr><tr><td>info</td><td>text</td><td>Nastavuje informace o JSP stránce. Tyto informace mohou být v servletu získány pomocí getServletInfo metody.</td></tr><tr><td>buffer</td><td>velikost (např. "16kb")</td><td>Nastavuje velikost vyrovnávací paměti pro zpracování výstupu vygenerovaného JSP stránkou (defaultní je 8kb). Popravdě úplně nevím k čemu to slouží.</td></tr><tr><td>language</td><td>skriptovací jazyk</td><td>Definuje skriptovací jazyk použitý v JSP stránce (defaultní je "java").</td></tr><tr><td>isELIgnored</td><td>true | false</td><td>Nastavuje, zda se má ignorovat expression language (defaultní je "false").</td></tr><tr><td>isThreadSafe</td><td>true | false</td><td>Definuje, zda je bezpečné, aby JSP stránka běžela pro více requestů zároveň (mohlo se používat více vláken). Defaultní hodnota je "true". Pokud ji změníme na "false", tak web container vždy počká, než JSP stránka zpracuje request aby jí mohl předat pro zpracování další (Vygeneruje pro ni servlet, který bude implementovat rozhraní <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/SingleThreadModel.html" target="_blank" class="link">SingleThreadModel</a>).</td></tr><tr><td>autoFlush</td><td>true | false</td><td>Nastavuje, zda se má vyrovnávací paměť automaticky vyprázdnit, když je plná, nebo se má vyhodit chyba. Nevím k čemu to slouží ale asi to má nějakou spojitost s atributem buffer.</td></tr><tr><td>session</td><td>true | false</td><td>Nastavuje, zda JSP stránka používá sessions. Defaultní hodnota je "true". Pokud ji nastavíme na "false", tak v JSP stránce nebude k dispozici implicitní objekt session.</td></tr><tr><td>pageEncoding</td><td>kódování</td><td>Nastavuje kódování stránky. Defaultní je "ISO-8859-1". Je vždy potřeba změnit na "UTF-8", aby se nám dobře zobrazoval český text.</td></tr><tr><td>errorPage</td><td>stránka</td><td>Nastavuje stránku, která se má zobrazit, když v JSP souboru dojde k chybě.</td></tr><tr><td>isErrorPage</td><td>true | false</td><td>Nastavuje, že se jedná o chybovou stránku. Implicitní objekt exception se dá použít jen na chybových stránkách.</td></tr></tbody></table></div><p class="paragraph u-mb-2">Jak jste si mohli v předchozí tabulce všimnout, tak atribut isELIgnored slouží k ignorování expression language. Co je expression language asi ještě nevíte, jelikož jsme se tím v tutoriálu zatím nezabývali. Je na to vyhrazená samostatná část.</p><p class="paragraph u-mb-2">Následující ukázka ukazuje příklad použití page direktivy. První řádek je potřeba dávat do každého JSP souboru pro správné zobrazení českého textu.</p><div data-code-box data-no-buttons class="u-mb-4"><pre data-code><code class="language-html">&lt;!-- tento řádek je potřeba vkládat do každé JSP stránky
     pro správné zobrazení českého textu --&gt;
&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;!-- naimportování třídy Date z balíčku java.util --&gt;
&lt;%@ page import="java.util.Date" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Page direktiva&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- Jelikož máme třídu Date naimportovanou, tak ji
    můžeme použít bez specifikování balíčku. --&gt;
    &lt;p&gt;Čas na serveru: &lt;%= new Date() %&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><h2 id="include-direktiva" class="heading-secondary u-mb-2">Include direktiva</h2><p class="paragraph u-mb-2">Pomocí direktivy include můžeme web containeru (Tomcatu) říct, aby při generování servletu přidal kód z jiných souborů. Díky tomu jsme například schopni oddělit části kódu, které by měli být společné pro všechny stránky.</p><p class="paragraph u-mb-2">Pro ukázku si založíme nový Maven projekt a vytvoříme si soubor header.jsp a footer.jsp. V souboru header.jsp vytvoříme kód pro hlavičku stránky a v souboru footer.jsp kód pro patičku stránky. Následující ukázky obsah pro tyto soubory ukazují. Tady v ukázce představují jen jeden řádek kódu, ale v praxi byste měli hlavičku a patičku stránky samozřejmě komplexnější.</p><div data-project="1" data-project-name="include-direktiva" class="u-mb-2"><ul data-project-folders><li data-opened>src<ul><li data-opened>main<ul><li data-java-packages-folder>java</li><li>resources</li><li data-opened>webapp</li></ul></li><li>test<ul><li>java</li><li>resources</li></ul></li></ul></li><li>target</li></ul><pre data-code="pom.xml"><code class="language-xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;io.github.jirkasa&lt;/groupId&gt;
    &lt;artifactId&gt;include-direktiva&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;name&gt;include-direktiva&lt;/name&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;17&lt;/java.version&gt;
        &lt;maven.compiler.source&gt;${java.version}&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;${java.version}&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;4.0.1&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre><pre data-code="header.jsp" data-folder="src/main/webapp" data-active><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;header&gt;Hlavička stránky&lt;/header&gt;</code></pre></div><div data-project="2" data-project-extends="1" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/webapp</li></ul><pre data-code="footer.jsp" data-folder="src/main/webapp" data-active><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;footer&gt;Patička stránky&lt;/footer&gt;</code></pre></div><p class="paragraph u-mb-2">Teď si vytvoříme JSP stránku, na které kód z vytvořených souborů pomocí direktivy include použijeme. Můžeme ji pojmenovat třeba jako stranka.jsp. Direktiva include má atribut file, kde se předává cesta k souboru, jehož obsah se má vložit. Následující ukázka ukazuje kód pro naši stránku.</p><div data-project="3" data-project-extends="2" class="u-mb-2"><ul data-project-commands><li data-command-open-folder-to-root>src/main/webapp</li></ul><pre data-code="stranka.jsp" data-folder="src/main/webapp" data-active><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Include direktiva&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;%@ include file="./header.jsp" %&gt;
    &lt;p&gt;Obsah stránky...&lt;/p&gt;
    &lt;%@ include file="./footer.jsp" %&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p class="paragraph u-mb-2">Pokud si aplikaci spustíte a stránku si otevřete (<a href="http://localhost:8080/include-direktiva/stranka.jsp" target="_blank" class="link">http://localhost:8080/include-direktiva/stranka.jsp</a>), uvidíte stránku, kterou ukazuje následující obrázek. Kód ze souborů header.jsp a footer.jsp se tedy na stránce použil.</p><img src="../../static/img/screenshots/StrankaSestavenaPomociIncludeDirektivy.png" alt="vygenerovaná stránka" class="image image--full-width image--with-border u-mb-6"><h2 id="taglib-direktiva" class="heading-secondary u-mb-2">Taglib direktiva</h2><p class="paragraph u-mb-2">Taglib direktiva slouží k nadefinování knihovny tagů. Díky tomu potom můžeme tagy z knihovny na stránce použít. V části "JSP Custom tagy" se naučíme vytvářet vlastní knihovny tagů, takže tuto direktivu potom použijeme pro použití tagů z knihovny na stránce.</p><p class="paragraph u-mb-2">Taglib direktiva má atribut uri, kde předáváme jakou knihovnu chceme použít, a atribut prefix, který značí pod jakým názvem ji chceme na stránce používat. Následující ukázka ukazuje příklad použití taglib direktivy.</p><div data-code-box data-no-buttons class="u-mb-6"><pre data-code><code class="language-html">&lt;%@ page contentType="text/html" pageEncoding="UTF-8"%&gt;
&lt;!-- Nadefinování knihovny tagů, kterou chceme používat. --&gt;
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Taglib direktiva&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- Tagy z knihovny můžeme používat pod prefixem, který jsme si definovali. --&gt;
    &lt;c:forEach var="i" begin="1" end="5"&gt;
        Řádek ${i}
    &lt;/c:forEach&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p class="paragraph u-mb-4">Pro tuto část je to vše. Prošli jsme si všechny direktivy, které nám JSP nabízí. V příští části se podíváme na action tagy.</p><div class="u-text-center"><a href="../jsp-action-tagy/" class="button-primary">Pokračovat na další část</a></div></main></div></div><footer class="footer"><div class="footer__content"><p class="footer__text">Tento web vytvořil <a href="https://jirkasa.github.io/" target="_blank" class="footer__link">Jiří Satora</a></p></div></footer></body></html>