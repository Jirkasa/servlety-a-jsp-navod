<!doctype html><html lang="cs"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,maximum-scale=2.2,minimum-scale=1"><link rel="icon" type="image/svg+xml" href="../../static/img/favicon.svg"><meta name="author" content="Jiří Satora"><meta name="description" content="V této části tutoriálu si ukážeme, jak můžeme vytvořit servlet zděděním třídy HttpServlet."><title>HTTP Servlet | Servlety a JSP - Návod</title><script src="../../static/js/highlight.min.js"></script><script>hljs.highlightAll()</script><script defer="defer" src="../../common.094d85ce485e92e2c2cb.js"></script><script defer="defer" src="../../618.274f04aa314232891610.js"></script><script defer="defer" src="../../tutorial.eb9162178c9dddad389b.js"></script><link href="../../css/style.9befb716022502a8a300.css" rel="stylesheet"></head><body><input type="hidden" id="PATH_TO_ROOT" value="../../"><header id="HeaderContainer" class="header"><div id="Header" class="header__container"><div class="header__content"><a href="../../" class="header__home-link">Servlety a JSP<span class="header__home-link-unimportant-part"> - Návod</span></a> <button id="NavigationToggleButton" class="menu-toggle-button">Otevřít/Zavřít menu<span class="menu-toggle-button__icon"></span></button><nav id="HeaderNavigation" class="header__navigation"><ul><li><a href="../../tutorial/priprava-pro-vyvoj/" class="header__navigation-link header__navigation-link--active">Tutoriál</a></li><li><a href="../../obsah/" class="header__navigation-link">Obsah</a></li><li><a href="../../dalsi-tutorialy/k-cemu-tato-sekce-slouzi/" class="header__navigation-link">Další tutoriály</a></li><li><a href="https://github.com/Jirkasa/servlety-a-jsp-navod" target="_blank" class="header__navigation-link">GitHub</a></li></ul></nav></div></div></header><div class="tutorial-page-layout"><div class="tutorial-page-layout__container"><nav id="TutorialNavigation" class="tutorial-page-layout__navigation-side"><ul class="navigation"><li><a href="../priprava-pro-vyvoj/" class="navigation__link">Příprava pro vývoj</a></li><li><a href="../uvod-do-servletu/" class="navigation__link">Úvod do Servletů</a></li><li><a href="../http-servlet/" class="navigation__link navigation__link--active">HTTP Servlet</a></li><li><a href="../sledovani-relace/" class="navigation__link">Sledování relace</a></li><li><a href="../komunikace-mezi-servlety/" class="navigation__link">Komunikace mezi Servlety</a></li><li><a href="../filtry/" class="navigation__link">Filtry</a></li><li><a href="../uvod-do-jsp/" class="navigation__link">Úvod do JSP</a></li><li><a href="../jsp-tagy-a-implicitni-objekty/" class="navigation__link">JSP tagy a implicitní objekty</a></li><li><a href="../jsp-direktivy/" class="navigation__link">JSP direktivy</a></li><li><a href="../jsp-action-tagy/" class="navigation__link">JSP action tagy</a></li><li><a href="../jsp-custom-tagy/" class="navigation__link">JSP custom tagy</a></li><li><a href="../jsp-expression-language/" class="navigation__link">JSP expression language</a></li><li><a href="../jstl/" class="navigation__link">JSTL</a></li><li><a href="../mvc-vzor/" class="navigation__link">MVC vzor</a></li><li><a href="../struts-framework/" class="navigation__link">Struts framework</a></li><li><a href="../prace-s-databazi/" class="navigation__link">Práce s databází</a></li></ul></nav><main class="tutorial-page-layout__content"><h1 class="heading-primary u-mb-4">HTTP Servlet</h1><p class="paragraph u-mb-4">V minulé části jste se dozvěděli co to jsou servlety a k čemu slouží. Také jste se mohli dozvědět, že existují v podstatě tři cesty jak vytvořit servlet. První dvě jsme si ukázali v minulé části. V této části si ukážeme vytvoření servletu zděděním třídy HttpServlet.</p><h2 id="trida-httpservlet" class="heading-secondary u-mb-2">Třída HttpServlet</h2><p class="paragraph u-mb-2">Pokud chceme vytvořit servlet, který pracuje pouze s protokolem HTTP, tak je nejlepší jej vytvořit zděděním třídy <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpServlet.html" target="_blank" class="link">HttpServlet</a>. Předchozí dvě možnosti tvorby servletů, které jsme si ukázali v minulé části, se hodí hlavně pro tvorbu servletů využívající jiné protokoly než HTTP. Třída HttpServlet nám totiž poskytuje kromě metody service i metody, které můžeme použít pro reakci na requesty poslané pomocí specifických HTTP metod. Tyto metody ukazuje následující tabulka. Volají se z metody service, kterou za nás implementuje HttpServlet. Nemusíme tedy v metodě service sami zjišťovat, o jaký typ requestu se jedná.</p><div class="table-wrapper u-mb-2"><table class="table"><thead><tr><th>Metoda</th><th>Popis</th></tr></thead><tbody><tr><td>doGet(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro GET requesty.</td></tr><tr><td>doHead(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro HEAD requesty.</td></tr><tr><td>doPost(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro POST requesty.</td></tr><tr><td>doPut(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro PUT requesty.</td></tr><tr><td>doDelete(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro DELETE requesty.</td></tr><tr><td>doOptions(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro OPTIONS requesty (pravděpodobně nepoužijete).</td></tr><tr><td>doTrace(HttpServletRequest req, HttpServletResponse res)</td><td>Volá se pro TRACE requesty (pravděpodobně nepoužijete).</td></tr></tbody></table></div><p class="paragraph u-mb-4">Možná jste si všimli, že pro metodu PATCH bohužel neexistuje v HttpServlet třídě metoda doPatch. Můžeme si pro ni ale podporu přidat, pokud bychom ji potřebovali. Později si v této části ukážeme, jak to udělat.</p><h2 id="http-servlet-request-a-http-servlet-response" class="heading-secondary u-mb-2">HTTP Servlet Request a HTTP Servlet Response</h2><p class="paragraph u-mb-4">Ve třídě HttpServlet se nepoužívají objekty typu <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletRequest.html" target="_blank" class="link">ServletRequest</a> a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletResponse.html" target="_blank" class="link">ServletResponse</a>, jako tomu je u třídy GenericServlet, ale používají se objekty typu <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpServletRequest.html" target="_blank" class="link">HttpServletRequest</a> a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpServletResponse.html" target="_blank" class="link">HttpServletResponse</a>. Jedná se o rozhraní, která rozhraní ServletRequest a ServletResponse rozšiřují a přidávají pár dalších metod, které můžeme použít. Tyto metody si můžete prohlédnout v dokumentaci.</p><h2 id="vytvoreni-http-servletu" class="heading-secondary u-mb-2">Vytvoření HTTP Servletu</h2><p class="paragraph u-mb-2">Pro ukázku vytvoření servletu zděděním třídy HttpServlet si opět vytvoříme servlet, který jen vyrenderuje jednoduchou HTML stránku. Vytvořte si nový Maven projekt (jak to udělat v Eclipse je popsáno v první části tutoriálu), který pojmenujte například jako http-servlet. Poté vytvořte třeba třídu MujServlet, které nastavte, že dědí od třídy HttpServlet.</p><div data-project="1" data-project-name="http-servlet" class="u-mb-2"><ul data-project-folders><li>src<ul><li>main<ul><li data-java-packages-folder>java</li><li>resources</li><li>webapp</li></ul></li><li>test<ul><li>java</li><li>resources</li></ul></li></ul></li><li>target</li></ul><pre data-code="pom.xml"><code class="language-xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;io.github.jirkasa&lt;/groupId&gt;
    &lt;artifactId&gt;http-servlet&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;name&gt;http-servlet&lt;/name&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;17&lt;/java.version&gt;
        &lt;maven.compiler.source&gt;${java.version}&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;${java.version}&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;4.0.1&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre><pre data-code="MujServlet.java" data-java-package data-java-package-opened data-active><code class="language-java">import javax.servlet.http.HttpServlet;

public class MujServlet extends HttpServlet {

}</code></pre></div><p class="paragraph u-mb-2">V naší servlet třídě můžeme implementovat metody, které jsou popsány výše v tabulce, pro zpracování requestů poslaných různými HTTP metodami. V našem případě chceme reagovat jen na GET requesty, takže přepíšeme metodu doGet. Vygenerujeme v ní jen jednoduchou webovou stránku, stejně jako v minulých částech tutoriálu.</p><div data-project="2" data-project-extends="1" class="u-mb-2"><pre data-code="MujServlet.java" data-java-package data-java-package-opened data-active><code class="language-java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class MujServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
        res.setContentType("text/html; charset=utf-8");
        try (PrintWriter out = res.getWriter()) {
            out.println("&lt;!DOCTYPE html&gt;");
            out.println("&lt;html&gt;");
            out.println("&lt;head&gt;");
            out.println("&lt;meta charset=\"UTF-8\"&gt;");
            out.println("&lt;title&gt;HTTP Servlet&lt;/title&gt;");
            out.println("&lt;/head&gt;");
            out.println("&lt;body&gt;");
            out.println("&lt;h1&gt;HTTP Servlet&lt;/h1&gt;");
            out.println("&lt;p&gt;Tento servlet byl vytvořen zděděním třídy HttpServlet.&lt;/p&gt;");
            out.println("&lt;/body&gt;");
            out.println("&lt;/html&gt;");
        }
    }
}</code></pre></div><p class="paragraph u-mb-2">Náš servlet je hotový, teď již jen zbývá namapovat jej na URL v souboru web.xml. Vytvoříme tedy ve složce webapp složku WEB-INF a v ní soubor web.xml. Náš servlet můžeme namapovat třeba jako domovskou stránku aplikace napsáním "/" do url-pattern elementu (vlastně to nastaví, že se to zavolá pro jakékoliv URL), jak ukazuje následující ukázka.</p><div data-project="3" data-project-extends="2" class="u-mb-2"><ul data-project-commands><li data-command-create-folder>src/main/webapp/WEB-INF</li><li data-command-open-folder-to-root>src/main/webapp/WEB-INF</li></ul><pre data-code="web.xml" data-folder="src/main/webapp/WEB-INF" data-active><code class="language-xml">&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://Java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" 
id="WebApp_ID" version="3.0"&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;MujServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;MujServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;MujServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</code></pre></div><p class="paragraph u-mb-2">Pokud si aplikaci spustíte, tak po navštívení <a href="http://localhost:8080/http-servlet/" target="_blank" class="link">http://localhost:8080/http-servlet/</a> uvidíte stránku, kterou ukazuje následující obrázek.</p><img src="../../static/img/screenshots/StrankaProServletVytvorenyZdedenimHttpServletTridy.png" alt="Stránka pro servlet vytvořený zděděním třídy HttpServlet" class="image image--full-width image--with-border u-mb-6"><h2 id="pridani-podpory-pro-metodu-patch" class="heading-secondary u-mb-2">Přidání podpory pro metodu PATCH</h2><p class="paragraph u-mb-2">Jak jsem již psal, tak pro HTTP metodu PATCH neexistuje v HttpServlet třídě metoda doPatch. Můžeme si ji ale sami přidat. Je k tomu potřeba přepsat metodu service, ve které zjistíme, jakou metodou byl poslán request. Pokud byl poslán metodou PATCH, tak zavoláme metodu doPatch, jinak zavoláme metodu service nadtřídy. Následující ukázka ukazuje, jak to udělat.</p><div data-code-box data-no-buttons class="u-mb-6"><pre data-code="MujServlet.java"><code class="language-java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class MujServlet extends HttpServlet {
    
    protected void doPatch(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
        res.setContentType("text/html; charset=utf-8");
        res.getWriter().write("PATCH request byl zpracován");
    }
        
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
        if (req.getMethod().equalsIgnoreCase("PATCH")) {
            doPatch(req, res);
        } else {
            super.service(req, res);
        }
    }
}</code></pre></div><p class="paragraph u-mb-4">To je pro tuto část vše. V příští části si ukážeme různé způsoby, jak ukládat informace o uživateli, když prochází webovými stránkami.</p><div class="u-text-center"><a href="../sledovani-relace/" class="button-primary">Pokračovat na další část</a></div></main></div></div><footer class="footer"><div class="footer__content"><p class="footer__text">Tento web vytvořil <a href="https://jirkasa.github.io/" target="_blank" class="footer__link">Jiří Satora</a></p></div></footer></body></html>